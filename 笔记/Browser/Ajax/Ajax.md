## Ajax

### 服务器相关的基础概念

> 了解 Ajax 之前，首先要知道什么是**服务器**，什么是**客户端**，两者之间传递是依赖于 Ajax

#### 客户端
> 概念：在前端开发中，客户端特指“**Web 浏览器**”
> 作用：将**互联网世界**中的 **Web 资源**加载、并呈现到**浏览器窗口**中供用户使用

常见的 '客户端浏览器' 有:
- Chrome 浏览器
- FireFox 浏览器
- Edge 浏览器
- Safari 浏览器

#### 服务器
> 概念：服务器是**提供计算服务**的设备
> 作用：在上网过程中，服务器专门负责**存放**资源和**对外提供**服务

比如: 
- 百度云服务器
    对外提供**资源上传和下载**的服务

- 知乎网站的服务器
    对外提供**Web 网页**的服务

#### 客户端与服务器通信的过程
> 客户端与服务器之间的通信过程，分为**请求** - **响应**两个步骤

- **请求的概念**：客户端通过网络去找服务器**要资源**的过程，叫做“**请求**”
- **响应的概念**：服务器把资源通过网络**发送给客户端**的过程，叫做“**响应**”

#### 资源与 URL 地址
> 网络上的资源保存在**服务器**中
> 客户端在请求服务器上的资源时，需要知道资源确切的**存放地址**

#### URL 地址
> 概念：URL 指的是**统一资源定位系统**（uniform resource locator 简称 URL）
> 作用：用来表示服务器上每个资源的确切访问路径。一个标准的 URL 地址主要由如下 4 部分构成:

http://www.igcx:80/images/dog.png
- http ==> **协议**
- www.igcx ==> **主机名**
- 80 ==> **端口号**
- images/dog.png ==> **资源的存放路径**

##### URL 地址 - 协议（protocol）
> 概念：协议是网络协议的简称，网络协议是通信计算机双方**必须共同遵守**的一组**约定**
> 如怎么样建立连接、怎么样互相识别等。只有遵守这个约定，计算机之间才能相互通信交流。
>
> > 好处：**保证能读懂对方发送过来的消息内容**

##### URL 地址 - 主机名（hostname）
> 概念：主机名用来**标识**互联网中服务器的**唯一性**
>
> > 好处：通过主机名，可以保证客户端在万千的服务器中，找到自己想访问的那台服务器

##### URL 地址 - 端口号（port）
> 概念：端口号是 0 - 65535 之间的整数，它的主要作用是表示一台计算机中的**特定进程**所提供的服务

在 http 协议中，如果 URL 地址中的端口号是 80，则 :80 端口可以省略不写, 例如:
- http://www.igcx:80/images/dog.png 可以简写为: 
- http://www.igcx/images/dog.png

##### URL 地址 - 路径（path）
> 概念：路径用来表示资源在服务器上具体的**存放位置**

#### 服务器对外提供的资源
> 在平时上网的过程中，常见的资源有

- 文字内容
- Image 图片
- Audio 音频
- Video 视频
- 。。。。。。

#### 数据也是资源
> 网页中的**数据，也是服务器对外提供的一种资源**。例如股票数据、各行业排行榜等

数据对于一个网页来说非常重要！ **数据是网页的灵魂！！**离开数据之后，哪怕这个网页做的再漂亮，也没有实际的作用

> 那在网页中**如何请求**服务器的数据呢？ 
>
> > 需要用到的技术：**Ajax**！


### 什么是 Ajax
> **Ajax** 是浏览器中的技术：用来**实现客户端网页请求服务器的数据**
> 它的英文全称是 **A**synchronous **J**avascript **A**nd **X**ML，简称 Ajax


### 生活当中的Ajax
> 动态检测**用户名是否被占用**
> 动态加载**搜索的建议列表**
> **局部刷新网页的数据**
> **百度热榜**

> 结论：网页中 Ajax 的**应用场景**无处不在，**有数据的地方就有 Ajax**！

### 使用Ajax请求数据的5种方式
> 客户端浏览器在请求服务器上的数据时，根据**操作性质**的不同，可以分为以下 5 种常见的操作

- POST
    向服务器**新增**数据


- GET
    从服务器**获取**数据


- DELETE
	**删除**服务器上的数据


- PUT
	更新服务器上的数据（侧重于**完整更新**：例如更新用户的完整信息）


- PATCH
	更新服务器上的数据（侧重于**部分更新**：例如只更新用户的手机号）

### 请求报文 & 响应报文

#### 什么是请求报文和响应报文

客户端与服务器通信的过程是基于**请求**与**响应**的。其中：
- **请求报文**规定了客户端**以什么格式**把数据**发送**给服务器
- **响应报文**规定了服务器**以什么格式**把数据**响应**给客户端

> 请求报文 - 格式

**请求报文**由**请求行**（request line）、**请求头部**（ header ）、**空行** 和 **请求体** 4 个部分组成
![请求报文](/Users/x/Documents/My-Life/笔记/Browser/Ajax/images/请求报文.png)

- 在浏览器中，GET 请求比较特殊，它只有请求头，没有请求体
- 在浏览器中，POST、PUT、PATCH、DELETE 请求既有请求头，又有请求体

> 响应报文 - 格式

**响应报文**由**状态行**、**响应头部**、**空行** 和 **响应体** 4 个部分组成
![请求报文](/Users/x/Documents/My-Life/笔记/Browser/Ajax/images/响应报文.png)

#### http 响应状态码

> 概念：http 响应状态码（Status Code）由**三位数字**组成，用来标识**响应成功与否**的状态
> 作用：客户端浏览器根据响应状态码，即可判断出这次 http 请求是**成功**还是**失败**了

**成功（2XX）**
| 状态码 | 原因短语        | 说明                                                         |
| ------ | --------------- | ------------------------------------------------------------ |
| 200    | OK              | 表示从客户端发来的请求在服务器端被正确处理                   |
| 201    | Created         | 请求已经被实现，⽽且有⼀个新的资源已经依据请求的需要⽽建⽴<br />通常是在POST请求，或是某些PUT请求之后创建了内容, 进行的返回的响应 |
| 202    | Accepted        | 请求服务器已接受，但是尚未处理，不保证完成请求<br />适合异步任务或者说需要处理时间比较长的请求，避免HTTP连接一直占用 |
| 204    | No content      | 表示请求成功，但响应报⽂不含实体的主体部分                   |
| 206    | Partial Content | 进⾏的是范围请求, 表示服务器已经成功处理了部分 GET 请求<br />响应头中会包含获取的内容范围 (常用于分段下载) |

**重定向（3XX）**

| 状态码  | 原因短语           | 说明                                                         |
| ------- | ------------------ | ------------------------------------------------------------ |
| 301     | Moved Permanently  | 永久性重定向，表示资源已被分配了新的 URL<br />比如，我们访问 **http**://www.baidu.com 会跳转到 **https**://www.baidu.com |
| 302     | Found              | 临时性重定向，表示资源临时被分配了新的 URL, 支持搜索引擎优化<br />首页, 个人中心, 遇到了需要登录才能操作的内容, 重定向 到 登录页 |
| 303     | See Other          | 对于POST请求，它表示请求已经被处理，客户端可以接着使用GET方法去请求Location里的URI。 |
| **304** | **Not Modified**   | **自从上次请求后，请求的网页内容未修改过。<br />服务器返回此响应时，不会返回网页内容。(协商缓存)** |
| 307     | Temporary Redirect | 对于POST请求，表示请求还没有被处理，客户端应该向Location里的URI重新发起POST请求。<br />不对请求做额外处理, 正常发送请求, 请求location中的url地址 |

因为post请求, 是非幂等的,  从302中, 细化出了 303 和 307

简而言之: 

- 301  302  307  都是重定向
- 304 协商缓存

**客户端错误（4XX）**

| 状态码  | 原因短语        | 说明                                        |
| ------- | --------------- | ------------------------------------------- |
| **400** | **Bad Request** | **请求报⽂存在语法错误(（传参格式不正确）** |
| 401     | UnAuthorized    | 权限认证未通过(没有权限)                    |
| 403     | Forbidden       | 表示对请求资源的访问被服务器拒绝            |
| 404     | Not Found       | 表示在服务器上没有找到请求的资源            |
| 408     | Request Timeout | 客户端请求超时                              |
| 409     | Confict         | 请求的资源可能引起冲突                      |

**服务端错误（5XX）**

| 状态码 | 原因短语                   | 说明                                                         |
| ------ | -------------------------- | ------------------------------------------------------------ |
| 500    | Internal Sever Error       | 表示服务器端在执⾏请求时发⽣了错误                           |
| 501    | Not Implemented            | 请求超出服务器能⼒范围，例如服务器不⽀持当前请求所需要的某个功能，<br />或者请求是服务器不⽀持的某个⽅法 |
| 503    | Service Unavailable        | 表明服务器暂时处于超负载或正在停机维护，⽆法处理请求         |
| 505    | Http Version Not Supported | 服务器不⽀持，或者拒绝⽀持在请求中使⽤的 HTTP 版本           |

问到状态码: 304   400  401??

当前端看到控制台报出 400 时, 请问一定是后台的问题么? 如何排查错误? (前端先检查传参格式是否有误)

#### http 响应状态码 Vs 业务状态码

正确区分**响应状态码**和**业务状态码**的不同，是保证使用 Ajax **不迷茫**的必要前提。从如下 3 个方面进行区分： 

- 1. 所处的位置 
- 2. 表示的结果 
- 3. 通用性

1. 所处的位置不同：
- 在**响应头**的**状态行**中所包含的状态码，叫做“**响应状态码**” 
- 在**响应体**的**数据中**所包含的状态码，叫做“**业务状态码**”

2. 表示的结果不同：
- 响应状态码只能表示**这次请求的**成功与否（成功地失败了） 
- 业务状态码用来表示**这次业务处理的**成功与否

3. 通用性不同： 
- 响应状态码是由 **http 协议规定的，具有**通用性。每个不同的状态码都有其标准的含义，不能乱用
- 业务状态码是**后端程序员自定义的，不具有**通用性

### 接口的概念

> 使用 Ajax 请求数据时，**被请求的 URL 地址**，就叫做**数据接口**（简称：**接口**或 **API 接口**）。 

同时，每个接口必须有对应的**请求方式**。例如：
- http://www.liulongbin.top:3009/api/getbooks 获取图书列表的接口(**GET** 请求) 
- http://www.liulongbin.top:3009/api/addbook  添加图书的接口（**POST** 请求）

> **接口文档**
>> **接口文档**就是**接口的使用说明书**，它是我们调用接口的依据

> 接口文档的格式 其中包含了接口的描述信息

| 组成部分 | 说明 |
| :----:| :----: |
| 接口名称 | 接口的名称，用来快速区分每个接口的作用</ br> 如：登录借口、添加图书接口 |
| 接口URL | 客户端发起Ajax 调用此接口时，请求的URL地址 |
| 请求方式 | 接口的请求方式，如：GET、POST、PUT、DELETE 等 |
| 请求参数 | 请求此接口时，需要发送到服务器的**查询参数**或**请求体** |
| 返回示例 | 当接口请求成功后，服务器响应回来的数据的基本格式 |
| 返回参数说明 | 接口响应结果的详细描述 |

> 接口测试工具能让我们在**不写任何代码**的情况下，对接口进行**调用**和**测试**，从而检查接口能否被正常访问
>> 最流行的接口测试工具是 **Postman**


**小结：**
1. 知道服务器相关基础概念
- 客户端、服务器、**URL地址的 4 个组成部分**

2. 知道客户端和服务器通信的过程
- 请求与响应、**常见的 5 种请求方式**
- 响应状态码、业务状态码

3. 使用 axios 发起 Ajax 请求
- axios(**配置选项**).then(**成功的回调**)
- method、url、params、data

4. 知道接口和接口文档的概念
- Ajax 请求的 url 地址就是接口
- 接口文档就是**接口的使用说明书**
